!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e:e(t)}(window,(function(t){"use strict";if(!t)throw new Error("FrostUI-Sortable requires a Window.");if(!("UI"in t))throw new Error("FrostUI-Sortable requires FrostUI.");const e=t.Core,s=t.DOM,i=t.dom,r=t.UI,l=t.document;class h extends r.BaseComponent{constructor(t,e){super(t,e),this._selector=this._settings.items,this._settings.handle&&(this._selector+=" "+this._settings.handle),this._enabled=!this._settings.disabled,this._refreshCursors(),this._events()}disable(){return this._enabled=!1,this}dispose(){i.removeEventDelegate(this._node,"mousedown.ui.sortable"),i.removeEvent(this._node,"receive.ui.sortable"),i.remove(this._placeholder),this._target=null,this._placeholder=null,this._currentSortable=null,super.dispose()}enable(){return this._enabled=!0,this}isDropTarget(){return this._settings.dropOnEmpty||this.items().length}items(){return i.find(this._settings.items,this._node)}}Object.assign(h.prototype,{_events(){const t=e.animation((t=>{i.hide(this._target),this._checkScroll(t.x,t.y),i.show(this._target)}));let s,r,l;i.addEventDelegate(this._node,"mousedown.ui.sortable touchstart.ui.sortable",this._selector,i.mouseDragFactory((t=>{if(t.button||!this._enabled||i.is(t.currentTarget,this._settings.cancel))return!1;t.preventDefault(),this._target=this._findTarget(t.currentTarget)}),(e=>{const h=(t=>"touches"in t&&t.touches.length?{x:t.touches[0].pageX,y:t.touches[0].pageY}:{x:t.pageX,y:t.pageY})(e);s||(s=!0,l=i.index(this._target),r=l,i.triggerEvent(this._node,"sort.ui.sortable",{detail:{target:this._target}}),this._buildPlaceholder(),this._initTarget(h.x,h.y),this._currentSortable=this._node),this._updateTarget(h.x,h.y);const o=this._findNearestSortable(h.x,h.y),n=i.isSame(this._node,o)?this.items():this.constructor.init(o).items(),a=this._findNearestItem(n,h.x,h.y);if(!a)return;this._updatePlaceholder(a,h.x,h.y);const _=i.index(this._placeholder);i.isSame(o,this._currentSortable)?r!==_&&i.triggerEvent(o,"sorting.ui.sortable",{detail:{target:this._target,placeholder:this._placeholder}}):(i.triggerEvent(this._currentSortable,"send.ui.sortable",{detail:{target:this._target,placeholder:this._placeholder}}),i.triggerEvent(o,"receive.ui.sortable",{detail:{target:this._target,placeholder:this._placeholder}})),r=_,this._currentSortable=o,this._settings.scroll&&t(h)}),(t=>{s?(t.preventDefault(),i.triggerEvent(this._currentSortable,"sorted.ui.sortable",{detail:{target:this._target,placeholder:this._placeholder}}),i.setAttribute(this._target,"style",this._originalStyle),this._settings.helperClass&&i.removeClass(this._target,this._settings.helperClass),i.before(this._placeholder,this._target),i.remove(this._placeholder),r===l&&i.isSame(this._currentSortable,this._node)||i.triggerEvent(this._currentSortable,"update.ui.sortable",{detail:{target:this._target}}),this._target=null,this._placeholder=null,this._currentSortable=null,s=!1,l=null,r=null):this._target=null}))),i.addEvent(this._node,"receive.ui.sortable",(t=>{this._refreshCursors()}))}}),Object.assign(h.prototype,{_checkScroll(e,r){let h=i.getScrollY(t),o=i.getScrollX(t);if(r<h+this._settings.scrollSensitivity)h=Math.max(0,h-this._settings.scrollSpeed);else if(r>h+i.height(t)-this._settings.scrollSensitivity){const t=i.height(l,s.SCROLL_BOX);h=Math.min(t,h+this._settings.scrollSpeed)}if(e<o+this._settings.scrollSensitivity)o=Math.max(0,o-this._settings.scrollSpeed);else if(e>o+i.width(t)-this._settings.scrollSensitivity){const t=i.width(l,s.SCROLL_BOX);o=Math.min(t,o+this._settings.scrollSpeed)}i.setScroll(l,o,h)},_findNearestItem(t,e,s){return t=t.filter((t=>!i.isSame(t,this._placeholder))),i.nearestTo(t,e,s,!0)},_findNearestSortable(t,e){if(!this._settings.connectWith)return this._node;const s=i.find(this._settings.connectWith).filter((t=>h.init(t).isDropTarget()));return s.length?i.nearestTo([this._node,...s],t,e,!0):this._node},_findTarget(t){return this._settings.handle?this.items().find((e=>i.hasDescendent(e,t))):t},_refreshCursors(){const t=i.find(this._selector,this._node);i.setStyle(t,"cursor",this._settings.cursor)}}),Object.assign(h.prototype,{_buildPlaceholder(){const t=i.tagName(this._target);if(this._placeholder=i.create(t,{class:i.getAttribute(this._target,"class")}),this._settings.placeholderClass&&i.addClass(this._placeholder,this._settings.placeholderClass),this._settings.forcePlaceholderSize){const t=i.rect(this._target,!0);i.setStyle(this._placeholder,{width:`${t.width}px`,height:`${t.height}px`})}i.before(this._target,this._placeholder)},_initTarget(t,e){this._originalStyle=i.getAttribute(this._target,"style");const s=i.rect(this._target,!0);this._settings.forceHelperSize&&i.setStyle(this._target,{width:`${s.width}px`,height:`${s.height}px`});let r=s.x,h=s.y;this._offsetX=Math.abs(r-t),this._offsetY=Math.abs(h-e);const o=i.findOne(this._settings.appendTo);let n;if(n=i.isSame(o,l.body)||"relative"!==i.css(o,"position")?i.closest(o,(t=>"relative"===i.css(t,"position")),l.body).shift():o,n){const t=i.position(n,!0);this._offsetX+=t.x,this._offsetY+=t.y,r-=t.x,h-=t.y}i.setStyle(this._target,"position","absolute"),"y"===this._settings.axis?i.setStyle(this._target,"left",r):"x"===this._settings.axis&&i.setStyle(this._target,"top",h),this._settings.opacity&&i.setStyle(this._target,"opacity",this._settings.opacity),i.setStyle(this._target,"zIndex",this._settings.zIndex),this._settings.helperClass&&i.addClass(this._target,this._settings.helperClass),i.append(o,this._target)},_updatePlaceholder(t,e,s){const r=i.center(t,!0),l=i.center(this._placeholder,!0);let h;h="y"===this._settings.axis||r.x===l.x?s<r.y?"before":"after":"x"===this._settings.axis||r.y===l.y?e<r.x?"before":"after":e<r.x&&s<r.y?"before":"after",i[h](t,this._placeholder)},_updateTarget(t,e){if(!this._settings.axis||"y"===this._settings.axis){const t=e-this._offsetY;i.setStyle(this._target,"top",`${t}px`)}if(!this._settings.axis||"x"===this._settings.axis){const e=t-this._offsetX;i.setStyle(this._target,"left",`${e}px`)}this._settings.containment&&i.constrain(this._target,this._settings.containment)}}),h.defaults={appendTo:"body",axis:null,cancel:"input, textarea, button, select, option",connectWith:null,containment:null,cursor:"auto",disabled:!1,dropOnEmpty:!0,forceHelperSize:!0,forcePlaceholderSize:!0,handle:null,helperClass:null,items:":scope > li",opacity:.9,placeholderClass:"bg-light",zIndex:1e3,scroll:!0,scrollSensitivity:20,scrollSpeed:20},r.initComponent("sortable",h),r.Sortable=h}));