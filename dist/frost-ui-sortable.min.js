!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@fr0st/ui"),require("@fr0st/query")):"function"==typeof define&&define.amd?define(["exports","@fr0st/ui","@fr0st/query"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).UI=t.UI||{},t.UI,t.fQuery)}(this,(function(t,e,s){"use strict";class i extends e.BaseComponent{constructor(t,e){super(t,e),this._selector=this._options.items,this._options.handle&&(this._selector+=" "+this._options.handle),this._enabled=!this._options.disabled,this._refreshCursors(),this._events()}disable(){this._enabled=!1}dispose(){s.removeEventDelegate(this._node,"mousedown.ui.sortable touchstart.ui.sortable"),s.removeEvent(this._node,"receive.ui.sortable"),this._target=null,this._currentSortable=null,super.dispose()}enable(){this._enabled=!0}items(){return s.find(this._options.items,this._node)}}i.defaults={appendTo:"body",axis:null,cancel:"input, textarea, button, select, option",connectWith:null,cursor:"auto",disabled:!1,dropOnEmpty:!0,handle:null,helperClass:"bg-body-tertiary",items:":scope > li",scroll:!0,scrollSensitivity:20,scrollSpeed:5};const o=i.prototype;o._checkScroll=function(){s.hide(this._target);const t=s.getScrollX(window),e=s.getScrollY(window);let i=t,o=e;if(this._pos.y<e+this._options.scrollSensitivity)o=Math.max(0,e-this._options.scrollSpeed);else if(this._pos.y>e+s.height(window)-this._options.scrollSensitivity){const t=s.height(document,{boxSize:s.SCROLL_BOX});o=Math.min(t,e+this._options.scrollSpeed)}if(this._pos.x<t+this._options.scrollSensitivity)i=Math.max(0,t-this._options.scrollSpeed);else if(this._pos.x>t+s.width(window)-this._options.scrollSensitivity){const e=s.width(document,{boxSize:s.SCROLL_BOX});i=Math.min(e,t+this._options.scrollSpeed)}i===t&&o===e||(s.setStyle(":root",{scrollBehavior:"initial"}),s.setScroll(document,i,o),s.setStyle(":root",{scrollBehavior:""}),this._pos.x+=i-t,this._pos.y+=o-e),s.show(this._target),this._checkScrollTimer=setTimeout((t=>{this._checkScroll()}),0)},o._events=function(){const t=s.mouseDragFactory((t=>{if(t.button||!this._enabled||s.is(t.currentTarget,this._options.cancel)||s.getDataset(this._node,"uiDragging"))return!1;this._target=this._options.handle?this.items().find((e=>s.hasDescendent(e,t.currentTarget))):t.currentTarget}),(t=>{this._pos=e.getPosition(t),s.getDataset(this._node,"uiDragging")||(s.setDataset(this._node,{uiDragging:!0}),this._startIndex=s.index(this._target),this._currentIndex=this._startIndex,s.triggerEvent(this._node,"sort.ui.sortable",{detail:{target:this._target}}),this._options.helperClass&&s.addClass(this._target,this._options.helperClass),this._currentSortable=this._node,this._options.scroll&&this._checkScroll());let i=this._node;if(this._options.connectWith){const t=s.find(this._options.connectWith).filter((t=>{const e=this.constructor.init(t);return e._options.dropOnEmpty||e.items().length}));t.length&&(i=s.nearestTo([this._node,...t],this._pos.x,this._pos.y,{offset:!0}))}const o=s.isSame(this._node,i)?this.items():this.constructor.init(i).items(),r=s.nearestTo(o,this._pos.x,this._pos.y,{offset:!0});if(!r)return;this._updateTarget(r,this._pos.x,this._pos.y);const n=s.index(this._target);s.isSame(i,this._currentSortable)?this._currentIndex!==n&&s.triggerEvent(i,"sorting.ui.sortable",{detail:{target:this._target}}):(s.triggerEvent(this._currentSortable,"send.ui.sortable",{detail:{target:this._target}}),s.triggerEvent(i,"receive.ui.sortable",{detail:{target:this._target}})),this._currentIndex=n,this._currentSortable=i}),(t=>{s.getDataset(this._node,"uiDragging")?("mouseup"===t.type&&t.preventDefault(),s.triggerEvent(this._currentSortable,"sorted.ui.sortable",{detail:{target:this._target}}),this._options.helperClass&&s.removeClass(this._target,this._options.helperClass),this._currentIndex===this._startIndex&&s.isSame(this._currentSortable,this._node)||s.triggerEvent(this._currentSortable,"update.ui.sortable",{detail:{target:this._target}}),s.removeDataset(this._node,"uiDragging"),this._checkScrollTimer&&(clearTimeout(this._checkScrollTimer),this._checkScrollTimer=null),this._target=null,this._currentSortable=null,this._currentIndex=null,this._startIndex=null):this._target=null}));s.addEventDelegate(this._node,"mousedown.ui.sortable touchstart.ui.sortable",this._selector,t),s.addEvent(this._node,"receive.ui.sortable",(t=>{this._refreshCursors()}))},o._refreshCursors=function(){const t=s.find(this._selector,this._node);s.setStyle(t,{cursor:this._options.cursor})},o._updateTarget=function(t,e,i){const o=s.center(t,{offset:!0}),r=s.center(this._target,{offset:!0});let n;n="y"===this._options.axis||o.x===r.x?i<o.y?"before":"after":"x"===this._options.axis||o.y===r.y?e<o.x?"before":"after":e<o.x&&i<o.y?"before":"after",s[n](t,this._target)},e.initComponent("sortable",i),t.Sortable=i}));